<html>
<head>
<script src="https://kihtrak.com/cloud_variable/cloudify.min.js"></script>
<style>
body {
  font: 100% arial;
}
table, th, td {
  border:1px solid black;
}
	</style>
<title>chatroom.</title>
</head>
<body>
<center>
<h1>chatroom.</h1>
<small>a terrible html based chatroom</small>

<script>
let person = prompt("Please enter your name:", "");
</script>

<table style="width:75%">
   <tr>
    <td id="8">-----</td>
  </tr>
     <tr>
    <td id="7">-----</td>
  </tr>
   <tr>
    <td id="6">-----</td>
  </tr>
 <tr>
    <td id="5">-----</td>
  </tr>
   <tr>
    <td id="4">-----</td>
  </tr>
  <tr>
    <td id="3">-----</td>
  </tr>
  <tr>
    <td id="2">-----</td>
  </tr>
  <tr>
    <td id="1">-----</td>
  </tr>
</table>

<script>
setInterval(update, 1000);

function update() {
  	 document.getElementById("1").innerHTML = cloud_one;
	 document.getElementById("2").innerHTML = cloud_two;
	 document.getElementById("3").innerHTML = cloud_three;
	 document.getElementById("4").innerHTML = cloud_four;
	 document.getElementById("5").innerHTML = cloud_five;
	 document.getElementById("6").innerHTML = cloud_six;
	 document.getElementById("7").innerHTML = cloud_seven;
	 document.getElementById("8").innerHTML = cloud_eight;
	 
}

</script>
<input type="text" id="message" placeholder="Message" size="70" autocomplete="off">
<button type="submit" onclick="load()" id="coolbutton">Submit</button>

<br>
<br>
<small>Upload Image</small>
<input type="file" accept="image/*" onchange="importFileandPreview()"><br>
<img hidden src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" height="200" alt="Image preview...">
<p id="srcAttribute" style="width: 200;word-wrap: break-word;"></p>

<script>
var input = document.getElementById("message");

input.addEventListener("keyup", function(load) {
  if (event.keyCode === 13) {
   event.preventDefault();
   document.getElementById("coolbutton").click();
  }
});


function load() {
	 message = document.getElementById("message").value;
	 
	 if (message == "") {
		 return
     }
	 

	 document.getElementById("message").value = "";
	 
	 cloud_one = document.getElementById("1").innerHTML;
	 cloud_two = document.getElementById("2").innerHTML;
	 cloud_three = document.getElementById("3").innerHTML;
	 cloud_four = document.getElementById("4").innerHTML;
	 cloud_five = document.getElementById("5").innerHTML;
	 cloud_six = document.getElementById("6").innerHTML;
	 cloud_seven = document.getElementById("7").innerHTML;
	 cloud_eight = document.getElementById("8").innerHTML;
	 
	 cloud_eight = cloud_seven;
	 cloud_seven = cloud_six;
	 cloud_six = cloud_five;
	 cloud_five = cloud_four;
	 cloud_four = cloud_three;
	 cloud_three = cloud_two;
	 cloud_two = cloud_one;
	 var today = new Date();
	 var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
	 cloud_one = "<p style='color:blue;'><b style='color:red;'>" + person + ": </b>" + message + " ";
	 cloud_one = cloud_one + "<i style='font-size:10px;color:#b8b8b8;'>" + time + "</i></p>"
	 
	 document.getElementById("1").innerHTML = cloud_one;
	 document.getElementById("2").innerHTML = cloud_two;
	 document.getElementById("3").innerHTML = cloud_three;
	 document.getElementById("4").innerHTML = cloud_four;
	 document.getElementById("5").innerHTML = cloud_five;
	 document.getElementById("6").innerHTML = cloud_six;
	 document.getElementById("7").innerHTML = cloud_seven;
	 document.getElementById("8").innerHTML = cloud_eight;
	 
	 cloud_chatlog = cloud_chatlog + "<br>" + cloud_eight;
}

function importFileandPreview() {
  var preview = document.querySelector('img');
  var file    = document.querySelector('input[type=file]').files[0];
  var reader  = new FileReader();

  reader.addEventListener("load", function () {
    preview.src = reader.result;
    message = "<img style='width: 200;' src='" + reader.result + "'> "
	sendmsg()
  }, false);

  if (file) {
    reader.readAsDataURL(file);
  }
}

function sendmsg() {
	 cloud_one = document.getElementById("1").innerHTML;
	 cloud_two = document.getElementById("2").innerHTML;
	 cloud_three = document.getElementById("3").innerHTML;
	 cloud_four = document.getElementById("4").innerHTML;
	 cloud_five = document.getElementById("5").innerHTML;
	 cloud_six = document.getElementById("6").innerHTML;
	 cloud_seven = document.getElementById("7").innerHTML;
	 cloud_eight = document.getElementById("8").innerHTML;
	 
	 cloud_eight = cloud_seven;
	 cloud_seven = cloud_six;
	 cloud_six = cloud_five;
	 cloud_five = cloud_four;
	 cloud_four = cloud_three;
	 cloud_three = cloud_two;
	 cloud_two = cloud_one;
	 var today = new Date();
	 var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
	 cloud_one = "<p style='color:blue;'><b style='color:red;'>" + person + ": </b>" + message + " ";
	 cloud_one = cloud_one + "<i style='font-size:10px;color:#b8b8b8;'>" + time + "</i></p>"
	 
	 document.getElementById("1").innerHTML = cloud_one;
	 document.getElementById("2").innerHTML = cloud_two;
	 document.getElementById("3").innerHTML = cloud_three;
	 document.getElementById("4").innerHTML = cloud_four;
	 document.getElementById("5").innerHTML = cloud_five;
	 document.getElementById("6").innerHTML = cloud_six;
	 document.getElementById("7").innerHTML = cloud_seven;
	 document.getElementById("8").innerHTML = cloud_eight;
}
</script>
